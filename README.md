# üîß VAE-Based Anomaly Detection for Bearing Fault Diagnosis (CWRU Dataset)

### üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞:
–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π –≤ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∞—Ö –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞—Ä–∏–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∞–≤—Ç–æ–∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞ (VAE) —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º. –ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ **—Å—ã—Ä—ã—Ö –≤–∏–±—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö** —Å –º–µ—Ç–∫–∞–º–∏ "–ù–æ—Ä–º–∞ / –ê–Ω–æ–º–∞–ª–∏—è", –≤—ã—è–≤–ª—è—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è –ø–æ –∏—Ö —Ñ–æ—Ä–º–µ.

---

### üìÅ –î–∞–Ω–Ω—ã–µ:
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–∞—Ç–∞—Å–µ—Ç [CWRU Bearing Data (NumPy —Ñ–æ—Ä–º–∞—Ç)](https://github.com/srigas/CWRU_Bearing_NumPy), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å–∏–≥–Ω–∞–ª—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π –∏ —Ä–µ–∂–∏–º–∞–º–∏ —Ä–∞–±–æ—Ç—ã (1730‚Äì1797 RPM).

---

### üß† –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:

**VAE + Classifier**:
- **Encoder:** `Conv1D` + `BatchNorm` + `LeakyReLU`
- **Latent space:** 64 –ø—Ä–∏–∑–Ω–∞–∫–∞ (Œº, logœÉ¬≤)
- **Decoder:** `ConvTranspose1D` –¥–ª—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞
- **Classifier:** –ª–∏–Ω–µ–π–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—é
- **Loss:**  
  - –†–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `MSE`  
  - KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è  
  - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è: `CrossEntropy`  
  - –û–±—â–∏–π –ª–æ—Å—Å: `VAE + Œ≥ * Classifier` (Œ≤=0.1, Œ≥=1.0)

---

### ‚öôÔ∏è –≠—Ç–∞–ø—ã:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤**  
2. **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è + –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è Conv1D**  
3. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train / val / test —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º file_id**  
4. **–†–∞–∑–±–∏–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ –æ–∫–Ω–∞ (512 —Ç–æ—á–µ–∫, —à–∞–≥ 256)**  
5. **–°–æ–∑–¥–∞–Ω–∏–µ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö DataLoader‚Äô–æ–≤**  
6. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Å —Ä–∞–Ω–Ω–µ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º**  
7. **–û—Ü–µ–Ω–∫–∞ –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º ROC-AUC, Accuracy, F1 (–Ω–∞ —É—Ä–æ–≤–Ω–µ —Ñ–∞–π–ª–æ–≤)**  
8. **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
   - –ü–æ—Ç–µ—Ä—å –∏ –º–µ—Ç—Ä–∏–∫
   - ROC-–∫—Ä–∏–≤–æ–π
   - –ú–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫
   - –ü—Ä–∏–º–µ—Ä–æ–≤ –Ω–æ—Ä–º/–∞–Ω–æ–º–∞–ª–∏–π

---

### üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –ú–µ—Ç—Ä–∏–∫–∞         | –ó–Ω–∞—á–µ–Ω–∏–µ     |
|-----------------|--------------|
| Accuracy        | **1.000**    |
| ROC-AUC         | **1.000**    |
| F1 Score        | **1.000**    |
| –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è  | ~7 –º–∏–Ω       |
| –ö–æ–ª-–≤–æ —ç–ø–æ—Ö     | 33 (early stop) |

---

### üîç –ö–∞–∫ –º–æ–¥–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–Ω–æ–º–∞–ª–∏–∏:

- –£—Å–∏–ª–µ–Ω–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –∞–º–ø–ª–∏—Ç—É–¥—ã  
- –ü–∏–∫–∏ –∏ –≤—ã–±—Ä–æ—Å—ã  
- –ù–∞—Ä—É—à–µ–Ω–∏–µ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏  
- –°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –∏—Å–∫–∞–∂–µ–Ω–∏—è  
- –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è KL-–¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è

---

### üõ† –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- `PyTorch`, `NumPy`, `Matplotlib`, `Scikit-learn`, `SciPy`

---
